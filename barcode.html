<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
    <title>二维码</title>
    <script src="js/mui.min.js"></script>
    <link href="css/mui.min.css" rel="stylesheet"/>
	<script src="js/jq.js" type="text/javascript" charset="utf-8"></script>
	<style type="text/css">
		#out{
			width: 90vw;
			height: 70vh;
			margin: auto;
			border: 2px solid #ccc;
		}
	</style>
</head>
<body>
	<header class="mui-bar mui-bar-nav">
		<h1 class="mui-title">二维码</h1>
	</header>
	<div class="mui-content">
		<div id="out">
			
		</div>
		<button type="button" class="mui-btn mui-btn-blue" id="btn">扫一扫</button>
		<button type="button" class="mui-btn mui-btn-blue" id="btn1">停止</button>
		<button type="button" class="mui-btn mui-btn-blue" id="btn2">关闭</button>
		<button type="button" class="mui-btn mui-btn-blue" id="btn3">闪光灯</button>
	</div>
	
</body>
<script type="text/javascript" charset="utf-8">
	// 扩展API加载完毕后调用onPlusReady回调函数 
	document.addEventListener( "plusready", function(){
		var scan = null;
		// 开启扫一扫,创建扫码控件,并开始扫描
		$('#btn').click(function(){
			scan = new plus.barcode.Barcode('out');
			scan.onmarked = onmarked; 
			scan.start();
		})
		
		// 停止扫描
		$('#btn1').click(function(){
			scan.cancel();
		})
		
		// 关闭扫描控件,把扫描控件移除
		$('#btn2').click(function(){
			scan.close();
		})
		
		// 打开闪光灯
		$('#btn3').click(function(){
			scan.setFlash(true)
		})
		
	}, false );
	function onmarked( type, result ) {
		var text = '未知: ';
		switch(type){
			case plus.barcode.QR:
			text = 'QR: ';
			break;
			case plus.barcode.EAN13:
			text = 'EAN13: ';
			break;
			case plus.barcode.EAN8:
			text = 'EAN8: ';
			break;
		}
		alert( text+result );
	}
</script>
</html>